Bootstrap: docker
From: ubuntu:22.04

%files
    . /opt/build_files
%post
    # Install dependencies
    apt-get update && apt-get install -y \
    build-essential \
    openmpi-bin \
    openmpi-common \
    cmake \
    libopenmpi-dev
                      
    cd /opt/build_files
    ls -la
    rm -rf build
    chmod +x build.sh
    ./build.sh
%files
    /opt/build_files/matrixA.txt /opt/build_files/build
    /opt/build_files/matrixB.txt /opt/build_files/build
%runscript
    cd /opt/build_files
    mv matrixA.txt matrixB.txt build
    cd /opt/build_files/build
    ls -la
    mpirun -n 2 ./main